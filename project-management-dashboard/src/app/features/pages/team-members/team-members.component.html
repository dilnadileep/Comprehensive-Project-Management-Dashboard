<div class="team-members-container">
  <h2>Team Members</h2>
  <button class="btn btn-primary" (click)="openAddModal()">Add New Team Member</button>

  <!-- Team Members Table -->
  <table *ngIf="teamMembers.length > 0" class="table">
    <thead>
      <tr>
        <th>Team Member Name</th>
        <th>Role</th>
        <th>Assigned Project</th>
        <th>Assigned Task</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let member of teamMembers">
        <td>{{ member.name }}</td>
        <td>{{ member.role }}</td>
        <td>{{ member.projectId | projectName: projects }}</td>
        <td>{{ member.taskId | taskName: tasks }}</td>
        <td>
          <!-- Show Assign to Project button only if the member is not assigned to a project -->
          <button
            class="btn btn-primary"
            *ngIf="!member.projectId"
            (click)="openModal(member, 'project')"
          >
            Assign to Project
          </button>
  
          <!-- Show Assign to Task button only if the member is not assigned to a task -->
          <button
            class="btn btn-secondary"
            *ngIf="!member.taskId"
            (click)="openModal(member, 'task')"
          >
            Assign to Task
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  

  <!-- Add Team Member Modal -->
  <div class="modal" *ngIf="isAddModalOpen">
    <div class="modal-content">
      <h4>Add Team Member</h4>
      <form (ngSubmit)="saveTeamMember()" #addForm="ngForm" novalidate>
        <div class="form-group">
          <label for="name">Name</label>
          <input id="name" [(ngModel)]="newTeamMember.name" name="name" required class="form-control"/>
        </div>

        <div class="form-group">
          <label for="role">Role</label>
          <input id="role" [(ngModel)]="newTeamMember.role" name="role" required class="form-control"/>
        </div>

        <div class="form-actions mt-3">
          <button type="submit" class="btn btn-success" [disabled]="addForm.invalid">Save</button>
          <button type="button" class="btn btn-danger" (click)="closeAddModal()">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Assign Modal -->
  <div class="modal" *ngIf="isModalOpen">
    <div class="modal-content">
      <h4>Assign {{ selectedMember?.name }}</h4>
      <p>Select {{ assignTo === 'project' ? 'Project' : 'Task' }}:</p>
      <select [(ngModel)]="selectedAssignId" class="form-control" required>
        <option *ngFor="let item of (assignTo === 'project' ? projects : tasks)" [value]="item.id">
          {{ item.name || item.title }}
        </option>
      </select>
      <div class="mt-3">
        <button class="btn btn-success" (click)="assignMember()">Assign</button>
        <button class="btn btn-danger" (click)="closeModal()">Cancel</button>
      </div>
    </div>
  </div>
</div>
